# üîç –°–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ Laravel

–ú–æ—â–Ω–∞—è –∏ –≥–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π, —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–¥–∞—á–∏
—Ñ–∏–ª—å—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ URL –∏–ª–∏ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞.

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–æ—Å–Ω–æ–≤–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è](#-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã-—Å—Ä–∞–≤–Ω–µ–Ω–∏—è)
- [–ë–∞–∑–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã](#-–±–∞–∑–æ–≤—ã–µ-—Ñ–∏–ª—å—Ç—Ä—ã)
- [–û–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —á–∏—Å–µ–ª](#-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã-–¥–ª—è-—á–∏—Å–µ–ª)
- [–û–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —Å—Ç—Ä–æ–∫](#-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã-–¥–ª—è-—Å—Ç—Ä–æ–∫)
- [–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–≤—è–∑—è–º](#-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è-–ø–æ-—Å–≤—è–∑—è–º)
- [–í–ª–æ–∂–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è](#-–≤–ª–æ–∂–µ–Ω–Ω—ã–µ-—É—Å–ª–æ–≤–∏—è)
- [–ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞](#-–ø–µ—Ä–µ–¥–∞—á–∞-—Ñ–∏–ª—å—Ç—Ä–æ–≤-–≤-—Ç–µ–ª–µ-–∑–∞–ø—Ä–æ—Å–∞)
- [–ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞](#-–ø–∞–≥–∏–Ω–∞—Ü–∏—è-–∏-—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)
- [–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã](#-—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ-–æ–ø–µ—Ä–∞—Ç–æ—Ä—ã)
- [–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤](#-–ø—Ä–∏–º–µ—Ä—ã-—Ä–µ–∞–ª—å–Ω—ã—Ö-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–≤-–∫–æ–¥–µ)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#Ô∏è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞](#-–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞)

---

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤**: `=`, `!=`, `>`, `<`, `>=`, `<=`, `like`, `in`, `not in`, `is null`
- **–í–ª–æ–∂–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è**: –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ `where`, `orWhere`, `whereNot`
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–≤—è–∑—è–º**: `whereHas`, `whereDoesntHave` —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏
- **–†–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø–æ–∏—Å–∫**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π `ILIKE` –¥–ª—è PostgreSQL
- **POST-—Ñ–∏–ª—å—Ç—Ä—ã**: –ø–µ—Ä–µ–¥–∞—á–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π `itemsPerPage`

---

## üéØ –û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

```php
// Enum: App\Support\QueryBuilders\Enums\AdvancedFilterOperator

'='          // EQUALS - —Ä–∞–≤–Ω–æ
'!='         // NOT_EQUALS - –Ω–µ —Ä–∞–≤–Ω–æ
'>'          // GREATER_THAN - –±–æ–ª—å—à–µ
'<'          // LESS_THAN - –º–µ–Ω—å—à–µ
'>='         // GREATER_THAN_OR_EQUAL - –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ
'<='         // LESS_THAN_OR_EQUAL - –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ
'like'       // LIKE - —Å–æ–¥–µ—Ä–∂–∏—Ç (—Å —Ä—É—á–Ω—ã–º–∏ %)
'%like%'     // LIKE_ANYWHERE - —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ
'%like'      // LIKE_ENDS_WITH - –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞
'like%'      // LIKE_STARTS_WITH - –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å
'not like'   // NOT_LIKE - –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç
'in'         // IN - –≤—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–æ–∫
'not in'     // NOT_IN - –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–æ–∫
'is'         // IS - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null/not_null
```

---

## üìå –ë–∞–∑–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã

### 1. **WHERE** - –ø—Ä–æ—Å—Ç—ã–µ —É—Å–ª–æ–≤–∏—è

**–ü—Ä–æ—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä `=`):

```
GET /api/users?where[status]=active
```

**–ú–∞—Å—Å–∏–≤ –∑–Ω–∞—á–µ–Ω–∏–π** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `IN`):

```
GET /api/users?where[status][]=active&where[status][]=pending
```

**–° —É–∫–∞–∑–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞**:

```
GET /api/users?where[age][operator]=>=&where[age][value]=18
```

**–ö–æ—Ä–æ—Ç–∫–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞**:

```
GET /api/users?where[age][op]=>=&where[age][value]=18
```

### 2. **OR WHERE** - —É—Å–ª–æ–≤–∏—è —Å –ò–õ–ò

**–ü–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—è–º**:

```
GET /api/users?orWhere[email]=test@example.com&orWhere[phone]=+380123456789
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ snake_case**:

```
GET /api/users?or_where[email]=test@example.com
```

### 3. **WHERE NOT** - –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ

**–ò—Å–∫–ª—é—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è**:

```
GET /api/users?whereNot[status]=banned
```

**–° –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º** (–∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):

```
GET /api/users?whereNot[age][operator]=<&whereNot[age][value]=18
```

–í—ã–ø–æ–ª–Ω–∏—Ç—Å—è –∫–∞–∫: `WHERE age >= 18`

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**:

```
GET /api/users?where_not[role]=guest
```

---

## üî¢ –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —á–∏—Å–µ–ª

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–µ–ª

**–ë–æ–ª—å—à–µ**:

```
GET /api/products?where[price][operator]=>&where[price][value]=100
```

**–ú–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ**:

```
GET /api/products?where[stock][operator]=<=&where[stock][value]=10
```

**–î–∏–∞–ø–∞–∑–æ–Ω** (–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ):

```
GET /api/products?where[price][operator]=>=&where[price][value]=50&whereNot[price][operator]=>&whereNot[price][value]=200
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: `WHERE price >= 50 AND price <= 200`

### IN / NOT IN –¥–ª—è —á–∏—Å–µ–ª

**–°–ø–∏—Å–æ–∫ ID**:

```
GET /api/users?where[id][]=1&where[id][]=5&where[id][]=10
```

**–Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ IN**:

```
GET /api/users?where[id][operator]=in&where[id][values][]=1&where[id][values][]=5
```

**–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π**:

```
GET /api/users?where[status_id][operator]=not in&where[status_id][values][]=3&where[status_id][values][]=7
```

---

## üìù –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —Å—Ç—Ä–æ–∫

### LIKE —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ wildcards

**–°–æ–¥–µ—Ä–∂–∏—Ç** (anywhere):

```
GET /api/users?where[name][operator]=%like%&where[name][value]=John
```

SQL: `WHERE name ILIKE '%John%'`

**–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å**:

```
GET /api/users?where[email][operator]=like%&where[email][value]=admin
```

SQL: `WHERE email ILIKE 'admin%'`

**–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞**:

```
GET /api/users?where[email][operator]=%like&where[email][value]=@example.com
```

SQL: `WHERE email ILIKE '%@example.com'`

**–†—É—á–Ω—ã–µ wildcards** (–æ–ø–µ—Ä–∞—Ç–æ—Ä like):

```
GET /api/users?where[phone][operator]=like&where[phone][value]=+380%
```

SQL: `WHERE phone ILIKE '+380%'`

### –†–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø–æ–∏—Å–∫

**–° —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–∏–ø–∞ string** (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç ILIKE –≤–º–µ—Å—Ç–æ LIKE):

```
GET /api/users?where[name][operator]=%like%&where[name][value]=john&where[name][type]=string
```

### NOT LIKE

**–ò—Å–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–æ–∫–∏**:

```
GET /api/users?where[email][operator]=not like&where[email][value]=%test%
```

SQL: `WHERE email NOT ILIKE '%test%'`

---

## üîó –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–≤—è–∑—è–º

### WHERE HAS - –Ω–∞–ª–∏—á–∏–µ —Å–≤—è–∑–∏

**–ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è**:

```
GET /api/users?whereHas[posts][where][status]=published
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**:

```
GET /api/users?where_has[posts][where][status]=published
```

### WHERE DOESNT HAVE - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤**:

```
GET /api/users?whereDoesntHave[posts][where][status]=published
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**:

```
GET /api/users?where_doesnt_have[posts][where][status]=published
```

---

## üé≠ –í–ª–æ–∂–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —Å–≤—è–∑–µ–π

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ—Å—Ç–∞–º–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ—Ç –∞–≤—Ç–æ—Ä–∞ "John"**:

```
GET /api/users?whereHas[posts][whereHas][comments][where][author_name][operator]=%like%&whereHas[posts][whereHas][comments][where][author_name][value]=John
```

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π –≤ —Å–≤—è–∑—è—Ö

**–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è**:

```
GET /api/orders?whereHas[items][where][quantity][operator]=>&whereHas[items][where][quantity][value]=5&whereHas[items][where][price][operator]=<&whereHas[items][where][price][value]=100&whereHas[items][whereNot][status]=cancelled
```

### WHERE –∏ OR WHERE –≤ —Å–≤—è–∑—è—Ö

**–°–≤—è–∑—å —Å OR —É—Å–ª–æ–≤–∏—è–º–∏**:

```
GET /api/users?whereHas[posts][where][status]=published&whereHas[posts][orWhere][status]=draft
```

SQL: `WHERE EXISTS (SELECT * FROM posts WHERE (status = 'published' OR status = 'draft'))`

### WHERE NOT –≤ —Å–≤—è–∑—è—Ö

**–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å–≤—è–∑—è—Ö**:

```
GET /api/users?whereHas[orders][whereNot][status]=cancelled&whereHas[orders][where][total][operator]=>&whereHas[orders][where][total][value]=1000
```

---

## üìÆ –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞

–°–∏—Å—Ç–µ–º–∞ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç** –ø–µ—Ä–µ–¥–∞—á—É —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ª—é–±—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

### üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ HTTP –º–µ—Ç–æ–¥—ã:

- ‚úÖ **POST** - –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
- ‚úÖ **PUT** / **PATCH** - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- ‚úÖ **GET** - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ **DELETE** - –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –≤ —Ç–µ–ª–µ

### üì¶ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:

#### 1. **JSON** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```http
POST /api/users
Content-Type: application/json

{
  "where": {
    "status": "active",
    "age": {
      "operator": ">=",
      "value": 18
    }
  },
  "page": 1,
  "itemsPerPage": 50
}
```

#### 2. **Form Data** (multipart/form-data)

```text
POST /api/users
Content-Type: multipart/form-data

where[status]=active
where[age][operator]=>=
where[age][value]=18
page=1
itemsPerPage=50
```

#### 3. **URL Encoded** (application/x-www-form-urlencoded)

```text
POST /api/users
Content-Type: application/x-www-form-urlencoded

where[status]=active&where[age][operator]=>=&where[age][value]=18&page=1&itemsPerPage=50
```

### üéØ –í–∞–∂–Ω–æ:

- Laravel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç **–≤—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã** —á–µ—Ä–µ–∑ `request()->input()`
- –ú–æ–∂–Ω–æ **–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å** URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (–æ–Ω–∏ –º—ë—Ä–¥–∂–∞—Ç—Å—è)
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏–º–µ—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ **—Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞** –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∫–ª—é—á–µ–π

---

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–î–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –∏ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **POST –∑–∞–ø—Ä–æ—Å—ã —Å JSON**:

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä

```http
POST /api/users
Content-Type: application/json

{
  "where": {
    "status": "active",
    "age": {
      "operator": ">=",
      "value": 18
    }
  },
  "whereNot": {
    "role": "guest"
  },
  "page": 1,
  "itemsPerPage": 50
}
```

### –°–ª–æ–∂–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä —Å–æ —Å–≤—è–∑—è–º–∏

```http
POST /api/orders
Content-Type: application/json

{
  "where": {
    "created_at": {
      "operator": ">=",
      "value": "2025-01-01"
    },
    "status": ["pending", "processing", "completed"]
  },
  "whereHas": {
    "customer": {
      "where": {
        "country": "US",
        "email": {
          "operator": "%like%",
          "value": "@example.com"
        }
      }
    },
    "items": {
      "where": {
        "price": {
          "operator": ">",
          "value": 50
        }
      },
      "whereNot": {
        "status": "cancelled"
      }
    }
  },
  "whereDoesntHave": {
    "refunds": {}
  },
  "sortBy": [
    {
      "key": "created_at",
      "order": "desc"
    }
  ],
  "itemsPerPage": 25
}
```

### –û—á–µ–Ω—å —Å–ª–æ–∂–Ω—ã–π –≤–ª–æ–∂–µ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä

```http
POST /api/projects
Content-Type: application/json

{
  "where": {
    "status": {
      "operator": "in",
      "values": ["active", "planning", "in_progress"]
    },
    "budget": {
      "operator": ">=",
      "value": 10000
    }
  },
  "whereHas": {
    "tasks": {
      "where": {
        "priority": "high"
      },
      "whereHas": {
        "assignee": {
          "where": {
            "department": "development",
            "experience_level": {
              "operator": ">=",
              "value": 3
            }
          },
          "whereDoesntHave": {
            "vacations": {
              "where": {
                "start_date": {
                  "operator": "<=",
                  "value": "2025-12-31"
                },
                "end_date": {
                  "operator": ">=",
                  "value": "2025-01-01"
                }
              }
            }
          }
        }
      },
      "whereNot": {
        "status": ["cancelled", "completed"]
      }
    }
  },
  "orWhere": {
    "manager_id": 5,
    "deputy_manager_id": 5
  },
  "sortBy": [
    {
      "key": "priority",
      "order": "desc"
    },
    {
      "key": "created_at",
      "order": "asc"
    }
  ],
  "page": 1,
  "itemsPerPage": 20
}
```

---

## üìä –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞

### –ë–∞–∑–æ–≤–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è

```
GET /api/users?page=2&itemsPerPage=50
```

### –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞

```
GET /api/users?sortBy[0][key]=created_at&sortBy[0][order]=desc&sortBy[1][key]=name&sortBy[1][order]=asc
```

### –í —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞

```json
{
    "sortBy": [
        {
            "key": "priority",
            "order": "desc"
        },
        {
            "key": "name",
            "order": "asc"
        }
    ],
    "page": 1,
    "itemsPerPage": 100
}
```

### –í—ã–±–æ—Ä –ø–æ–ª–µ–π

**URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:

```
GET /api/users?fields[]=id&fields[]=name&fields[]=email
```

**–í —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞**:

```json
{
    "fields": [
        "id",
        "name",
        "email"
    ],
    "where": {
        "status": "active"
    }
}
```

---

## üîç –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã

### IS NULL / IS NOT NULL

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NULL**:

```
GET /api/users?where[deleted_at][operator]=is&where[deleted_at][value]=null
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ NOT NULL**:

```
GET /api/users?where[email_verified_at][operator]=is&where[email_verified_at][value]=not_null
```

### –ü–æ–∏—Å–∫ –ø–æ –∫–∞—Å—Ç–æ–º–Ω—ã–º –ø–æ–ª—è–º

–ü–æ–∏—Å–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º ILIKE –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—è–º (–ø–∞—Ä–∞–º–µ—Ç—Ä `filter`):

```
GET /api/users?filter[name]=John&filter[email]=example.com
```

–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∫: `WHERE (name ILIKE '%John%' OR email ILIKE '%example.com%')`

---

## üí° –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### 1. E-commerce: –§–∏–ª—å—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤

```http
POST /api/products
Content-Type: application/json

{
  "where": {
    "status": "active",
    "price": {
      "operator": ">=",
      "value": 10
    }
  },
  "whereNot": {
    "price": {
      "operator": ">",
      "value": 1000
    }
  },
  "whereHas": {
    "category": {
      "where": {
        "slug": ["electronics", "computers"]
      }
    },
    "reviews": {
      "where": {
        "rating": {
          "operator": ">=",
          "value": 4
        }
      }
    }
  },
  "whereDoesntHave": {
    "outOfStockNotifications": {}
  },
  "sortBy": [
    {
      "key": "popularity",
      "order": "desc"
    }
  ]
}
```

### 2. CRM: –ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤

```http
POST /api/customers
Content-Type: application/json

{
  "where": {
    "created_at": {
      "operator": ">=",
      "value": "2025-01-01"
    }
  },
  "orWhere": {
    "email": {
      "operator": "%like%",
      "value": "@corporate.com"
    },
    "phone": {
      "operator": "like%",
      "value": "+380"
    }
  },
  "whereHas": {
    "orders": {
      "where": {
        "total": {
          "operator": ">",
          "value": 5000
        },
        "status": ["completed", "shipped"]
      }
    }
  },
  "whereDoesntHave": {
    "complaints": {
      "where": {
        "resolved": false
      }
    }
  }
}
```

### 3. HR: –ü–æ–¥–±–æ—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

```http
POST /api/employees
Content-Type: application/json

{
  "where": {
    "employment_status": "active",
    "experience_years": {
      "operator": ">=",
      "value": 2
    }
  },
  "whereHas": {
    "skills": {
      "where": {
        "name": ["PHP", "Laravel", "PostgreSQL"]
      }
    },
    "department": {
      "where": {
        "location": "Remote"
      },
      "whereNot": {
        "name": "Support"
      }
    }
  },
  "whereDoesntHave": {
    "vacations": {
      "where": {
        "end_date": {
          "operator": ">",
          "value": "2025-10-15"
        }
      }
    }
  }
}
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ

```php
use App\Models\User;

class UserController extends Controller
{
    public function index()
    {
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏–∑ request()
        return User::query()->paginateFiltered('users.created_at');
    }
    
    public function search()
    {
        // –° –∫–∞—Å—Ç–æ–º–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        $users = User::query()
            ->filter('users.name')
            ->paginate(25);
            
        return response()->json($users);
    }
}
```

### –í –º–æ–¥–µ–ª–∏

```php
use App\Support\QueryBuilders\CustomQueryBuilder;
use Illuminate\Database\Eloquent\Model;

class Product extends Model
{
    public static string $DEFAULT_SORT_DIRECTION = 'asc';

    public function newEloquentBuilder($query): CustomQueryBuilder
    {
        return new CustomQueryBuilder($query);
    }
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö RAW —É—Å–ª–æ–≤–∏–π

```php
Product::query()
    ->addRawFilterConditions([
        'products.sku LIKE ?' => 'search',
        'products.barcode LIKE ?' => 'search'
    ])
    ->paginateFiltered();
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```php
CustomQueryBuilder::DEFAULT_SORT_DIRECTION = 'desc';
CustomQueryBuilder::DEFAULT_PER_PAGE = 20;
```

### –í –º–æ–¥–µ–ª–∏

```php
class User extends Model
{
    // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    public static string $DEFAULT_SORT_DIRECTION = 'asc';
    
    // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    protected $perPage = 50;
}
```

---

## üìò –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **CustomQueryBuilder** - –≥–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å, —Ä–∞—Å—à–∏—Ä—è—é—â–∏–π `Illuminate\Database\Eloquent\Builder`
2. **–§–∏–ª—å—Ç—Ä—ã**:
    - `WhereFilter` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ WHERE —É—Å–ª–æ–≤–∏–π
    - `OrWhereFilter` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ OR WHERE —É—Å–ª–æ–≤–∏–π
    - `WhereNotFilter` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ WHERE NOT —É—Å–ª–æ–≤–∏–π
    - `WhereHasFilter` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–≤—è–∑—è–º
    - `WhereDoesntHaveFilter` - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–µ–π
    - `CustomFieldFilter` - –ø–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—è–º

3. **Support –∫–ª–∞—Å—Å—ã**:
    - `ConditionFactory` - —Å–æ–∑–¥–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
    - `OperatorExecutor` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∫ –∑–∞–ø—Ä–æ—Å—É
    - `ConditionPayload` - DTO –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —É—Å–ª–æ–≤–∏–π
    - `AbstractRelationFilter` - –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–≤—è–∑–µ–π

4. **Enum**:
    - `AdvancedFilterOperator` - —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ï–¥–∏–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å** - –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è URL –∏ POST –∑–∞–ø—Ä–æ—Å–æ–≤  
‚úÖ **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Enum –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤  
‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã  
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ª–µ–Ω–∏–≤–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤  
‚úÖ **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –ø–æ–Ω—è—Ç–Ω—ã–π DSL –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏  
‚úÖ **–í–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å** - –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: 1.0  
**–î–∞—Ç–∞**: 2025-10-15
